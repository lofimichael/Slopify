{
  document.querySelector(".cl-showpos .url").textContent =
    document.location.host + document.location.pathname;

  let lastTime = 0;
  let fps = 0;

  function calculateFPS(timestamp) {
    if (lastTime !== 0) {
      const deltaTime = timestamp - lastTime;
      fps = Math.round(1000 / deltaTime);
    }
    lastTime = timestamp;

    // update fps
    document.querySelector(".cl-showpos .fps").textContent = fps;

    requestAnimationFrame(calculateFPS);
  }

  requestAnimationFrame(calculateFPS);
}

{
  let lastTime = performance.now();
  let lastX = 0;
  let lastY = 0;
  let smoothVel = 0;
  const smoothingFactor = 0.2;

  let frameId;
  const fpsLimit = 300;
  const frameTime = 1000 / fpsLimit;

  document.addEventListener("mousemove", function (event) {
    if (frameId) {
      return;
    }

    frameId = setTimeout(() => {
      frameId = null;

      const currentTime = performance.now();
      const deltaTime = currentTime - lastTime;

      if (deltaTime > 0) {
        const x = event.clientX;
        const y = event.clientY;

        const deltaX = x - lastX;
        const deltaY = y - lastY;
        const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);

        const currentVel = distance / (deltaTime / 1000);

        smoothVel =
          smoothVel * (1 - smoothingFactor) + currentVel * smoothingFactor;

        document.querySelector(".cl-showpos .pos").textContent =
          `pos:  ${x}.00 ${y}.00 0.00`;
        document.querySelector(".cl-showpos .vel").textContent =
          `vel:  ${smoothVel.toFixed(2)}`;

        lastX = x;
        lastY = y;
        lastTime = currentTime;
      }
    }, frameTime);
  });

  let resetTimer;
  document.addEventListener("mousemove", function () {
    clearTimeout(resetTimer);
    resetTimer = setTimeout(() => {
      smoothVel = 0;
      document.querySelector(".cl-showpos .vel").textContent = "vel:  0.00";
    }, 100);
  });
}

{
  // Generated by Claude
  const element = document.querySelector(".cl-showpos");
  const MAX_DISTANCE = 500;

  document.addEventListener("mousemove", (e) => {
    const rect = element.getBoundingClientRect();
    const centerX = rect.left + rect.width / 2;
    const centerY = rect.top + rect.height / 2;

    const isInside =
      e.clientX >= rect.left &&
      e.clientX <= rect.right &&
      e.clientY >= rect.top &&
      e.clientY <= rect.bottom;

    if (isInside) {
      element.style.opacity = "0";
    } else {
      const distance = Math.hypot(e.clientX - centerX, e.clientY - centerY);

      const opacity = Math.min(0.8, distance / MAX_DISTANCE);
      element.style.opacity = opacity.toFixed(2);
    }
  });
}
